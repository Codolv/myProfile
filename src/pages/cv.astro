---
import BaseLayout from '../layouts/BaseLayout.astro';
import { personalData } from '../data/personalData.js';

const title = `CV – ${personalData.personalInfo.name}`;
const description =
  `Lebenslauf von ${personalData.personalInfo.name} – ${personalData.personalInfo.title}. Export als PDF über Druckfunktion.`;
---

<BaseLayout {title} {description}>
  <section class="space-y-6 rounded-2xl border border-slate-800 bg-[#0e1102]/60 p-6 shadow-lg shadow-slate-950/50">
    <div class="flex flex-col gap-4 border-b border-slate-800 pb-4 md:flex-row md:items-center md:justify-between">
      <div>
        <h1 class="text-2xl font-semibold tracking-tight text-[#faf9f6]">{personalData.personalInfo.name}</h1>
        <p class="text-sm text-amber-50/90">{personalData.personalInfo.title}</p>
        <p class="text-xs text-amber-100/70">{personalData.personalInfo.location}</p>
        <p class="text-xs text-amber-100/70">E-Mail: {personalData.personalInfo.email}</p>
      </div>
      <div class="flex gap-2">
        <button
          id="cv-print-btn"
          class="rounded-full border border-amber-500/60 px-4 py-2 text-xs font-medium text-amber-100 transition hover:bg-amber-500 hover:text-[#0a0a0a]"
        >
          Als PDF exportieren
        </button>
        <a
          href="/cv.pdf"
          class="rounded-full border border-amber-500/60 px-4 py-2 text-xs font-medium text-amber-100 transition hover:bg-amber-500 hover:text-[#0a0a0a]"
          target="_blank"
          rel="noreferrer"
          download
        >
          CV herunterladen
        </a>
        <a
          href="/profile.jpg"
          class="rounded-full border border-slate-700 px-4 py-2 text-xs font-medium text-[#faf9f6] transition hover:border-amber-500/60 hover:text-amber-100"
          target="_blank"
          rel="noreferrer"
        >
          Foto öffnen
        </a>
      </div>
    </div>

    <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
      <div class="space-y-6">
        <section class="space-y-3">
          <h2 class="text-sm font-semibold tracking-tight text-[#faf9f6]">Berufserfahrung</h2>

          {personalData.experience.map((job) => (
            <article class="rounded-xl border border-slate-800 bg-[#0e1102]/60 p-4">
              <header class="flex flex-col gap-1 sm:flex-row sm:items-baseline sm:justify-between">
                <h3 class="text-sm font-semibold text-[#faf9f6]">{job.company}</h3>
                <p class="text-xs text-amber-100/70">{job.period} · {job.position}</p>
              </header>
              <p class="mt-2 text-xs leading-relaxed text-amber-50/90">
                {job.description}
              </p>
              {job.technologies.length > 0 && (
                <p class="mt-2 text-[11px] text-amber-100/70">
                  Technologien: {job.technologies.join(', ')}.
                </p>
              )}
            </article>
          ))}
        </section>
      </div>

      <div class="space-y-6">
        <section class="rounded-xl border border-slate-800 bg-[#0e1102]/60 p-4">
          <h2 class="text-sm font-semibold tracking-tight text-[#faf9f6]">Kern-Skills</h2>
          <ul class="mt-3 space-y-2 text-xs text-amber-50/90">
            <li>Java, Java-EE, Java 17; Spring Boot, Quarkus, EJB 3.1, JPA/EclipseLink</li>
            <li>REST/GraphQL, Kafka, Docker, Kubernetes, CI/CD (Jenkins, GitHub Actions)</li>
            <li>OSCI/XÖV, Microservices, Reactive (Mutiny), DDD, Hexagonal</li>
            <li>Frontend: Angular, JSF/Primefaces; XML/XSLT/XPath, JSON</li>
            <li>Datenbanken: Oracle; Infrastruktur: Tomcat, Oracle Weblogic</li>
          </ul>
        </section>

        <section class="rounded-xl border border-slate-800 bg-[#0e1102]/60 p-4">
          <h2 class="text-sm font-semibold tracking-tight text-[#faf9f6]">Zertifizierungen</h2>
          <ul class="mt-3 space-y-2 text-xs text-amber-50/90">
            {personalData.certifications.map((cert) => (
              <li>{cert.date} – {cert.title}</li>
            ))}
          </ul>
        </section>

        <section class="rounded-xl border border-slate-800 bg-[#0e1102]/60 p-4">
          <h2 class="text-sm font-semibold tracking-tight text-[#faf9f6]">Beruflicher Werdegang</h2>
          <ul class="mt-3 space-y-2 text-xs text-amber-50/90">
            <li>2025 – jetzt: SThree GmbH (Arbeitnehmerüberlassung)</li>
            <li>2012 – 2025: ITech Progress GmbH (Consultant)</li>
            <li>2009 – 2012: ZTT, FH Worms (Programmierer)</li>
          </ul>
        </section>

        <section class="rounded-xl border border-slate-800 bg-[#0e1102]/60 p-4">
          <h2 class="text-sm font-semibold tracking-tight text-[#faf9f6]">Ausbildung</h2>
          <ul class="mt-3 space-y-2 text-xs text-amber-50/90">
            {personalData.education.map((edu) => (
              <li>
                {edu.period}: {edu.degree} {edu.institution}
                {edu.details && ` (${edu.details})`}
              </li>
            ))}
          </ul>
        </section>
      </div>
    </div>
  </section>

  <style>
    @media print {
      body {
        background: #fff;
      }
      .no-print {
        display: none !important;
      }
      .shadow-lg,
      .shadow-xl,
      .shadow-inner,
      .shadow-slate-950\/50,
      .shadow-slate-950\/60 {
        box-shadow: none !important;
      }
      .border-slate-800,
      .bg-slate-900\/40,
      .bg-slate-950\/40 {
        border-color: #ddd !important;
        background: #fff !important;
      }
      a {
        color: #000 !important;
        text-decoration: none;
      }
    }
  </style>

  <script is:inline>
    if (typeof window !== 'undefined') {
      const btn = document.getElementById('cv-print-btn');
      btn?.addEventListener('click', () => window.print());
    }
  </script>
</BaseLayout>